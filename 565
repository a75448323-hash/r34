<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Мой ID</title>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    :root {
      --bg: #fff;
      --text: #000;
    }

    body {
      margin: 0;
      height: 100vh;
      overflow: hidden;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    /* Текст поверх снега */
    #out {
      position: relative;
      z-index: 3;
      padding: 10px 14px;
      line-height: 1.35;
    }

    /* Слой со снегом */
    #snow {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 2;
    }

    .flake {
      position: absolute;
      top: -10vh;
      width: var(--s);
      height: var(--s);
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.95);
      filter: blur(0.2px);
      opacity: var(--o);
      left: var(--x);
      animation: fall var(--d) linear infinite;
      will-change: transform;
    }

    @keyframes fall {
      0%   { transform: translate3d(0, -12vh, 0); }
      100% { transform: translate3d(var(--drift), 112vh, 0); }
    }

    /* Сосульки */
    #icicles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 90px;
      pointer-events: none;
      z-index: 4;
      background: linear-gradient(to bottom, rgba(0,0,0,0.06), transparent 70%);
    }

    /* Ряд сосулек делаем градиентом */
    #icicles::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        /* повторяющиеся “треугольники” сосулек */
        repeating-linear-gradient(
          90deg,
          transparent 0 8px,
          rgba(220, 240, 255, 0.95) 8px 10px,
          transparent 10px 18px
        );
      mask:
        /* маска формирует “зубцы” вниз разной длины */
        repeating-linear-gradient(
          90deg,
          #000 0 18px,
          transparent 18px 22px
        );
      opacity: 1;
    }

    /* Делаем “капли” сосулек разной длины */
    #icicles::after {
      content: "";
      position: absolute;
      top: 18px;
      left: 0;
      width: 100%;
      height: 72px;
      background:
        linear-gradient(to bottom, rgba(220,240,255,0.98), rgba(220,240,255,0.0));
      clip-path: polygon(
        0 0,
        3% 0, 4% 55%, 5% 0,
        10% 0, 11% 80%, 12% 0,
        17% 0, 18% 45%, 19% 0,
        25% 0, 26% 95%, 27% 0,
        33% 0, 34% 60%, 35% 0,
        41% 0, 42% 85%, 43% 0,
        50% 0, 51% 50%, 52% 0,
        58% 0, 59% 90%, 60% 0,
        66% 0, 67% 65%, 68% 0,
        74% 0, 75% 98%, 76% 0,
        82% 0, 83% 58%, 84% 0,
        90% 0, 91% 88%, 92% 0,
        97% 0, 98% 52%, 100% 0,
        100% 100%, 0 100%
      );
      opacity: 0.9;
    }
  </style>
</head>

<body>
  <div id="icicles"></div>
  <div id="snow"></div>

  <div id="out">Загрузка…</div>

  <script>
    // Telegram user info
    const tg = window.Telegram.WebApp;
    tg.ready();

    const u = tg.initDataUnsafe?.user;
    const out = document.getElementById("out");

    if (!u) {
      out.textContent = "Открой через Telegram Mini App";
    } else {
      out.innerHTML = 
        ID: ${u.id}<br>
        Ник: ${u.username ?? "нет"}<br>
        Имя: ${u.first_name ?? ""}
      ;
    }

    // Snow generator
    const snow = document.getElementById("snow");
    const FLAKES = 45; // больше = гуще

    function rand(min, max) {
      return Math.random() * (max - min) + min;
    }

    for (let i = 0; i < FLAKES; i++) {
      const f = document.createElement("div");
      f.className = "flake";

      const size = rand(2, 6);
      const dur = rand(6, 14);
      const op = rand(0.35, 0.95);
      const x = rand(0, 100);
      const drift = rand(-30, 30) + "px";
      const delay = rand(0, dur) * -1
f.style.setProperty("--s", size + "px");
      f.style.setProperty("--d", dur + "s");
      f.style.setProperty("--o", op);
      f.style.setProperty("--x", x + "vw");
      f.style.setProperty("--drift", drift);
      f.style.animationDelay = delay + "s";

      snow.appendChild(f);
    }
  </script>
</body>
</html>
